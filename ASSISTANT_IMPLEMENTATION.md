# –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã "–ü–æ–º–æ—â–Ω–∏–∫–æ–≤" –≤ PPEE-Flask

## –ß—Ç–æ –±—ã–ª–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### 1. –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

#### –ù–æ–≤—ã–µ –º–æ–¥–µ–ª–∏:
- **`Conversation`** (`app/models/conversation.py`) - –º–æ–¥–µ–ª—å –¥–∏–∞–ª–æ–≥–∞ –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –∏ –ø–æ–º–æ—â–Ω–∏–∫–æ–º
- **`Message`** - –º–æ–¥–µ–ª—å —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –¥–∏–∞–ª–æ–≥–µ (–≤ —Ç–æ–º –∂–µ —Ñ–∞–π–ª–µ)

#### –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏:
- **`Application`** - —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ Assistant (–ü–æ–º–æ—â–Ω–∏–∫) —Å –Ω–æ–≤—ã–º–∏ –ø–æ–ª—è–º–∏:
  - `assistant_type` - —Ç–∏–ø –ø–æ–º–æ—â–Ω–∏–∫–∞ (support, qa, analyzer, custom)
  - `system_prompt` - —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç
  - `llm_model`, `temperature`, `max_tokens` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ LLM
  - `is_public` - –ø—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø
  - `enable_search`, `search_limit`, `use_reranker` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–∏—Å–∫–∞
  - `total_conversations`, `total_messages`, `average_rating` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

- **`Checklist`** - —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ PromptTemplate —Å –Ω–æ–≤—ã–º–∏ –ø–æ–ª—è–º–∏:
  - `template_type` - —Ç–∏–ø —à–∞–±–ª–æ–Ω–∞
  - `prompt_text` - —Ç–µ–∫—Å—Ç –ø—Ä–æ–º–ø—Ç–∞
  - `response_format` - —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞
  - `usage_count`, `rating` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### 2. –ù–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

#### Blueprint `/chat`:
- `/chat/` - –≤—ã–±–æ—Ä –ø–æ–º–æ—â–Ω–∏–∫–∞ –¥–ª—è –¥–∏–∞–ª–æ–≥–∞
- `/chat/assistant/<id>` - —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —á–∞—Ç–∞ —Å –ø–æ–º–æ—â–Ω–∏–∫–æ–º
- `/chat/api/send_message` - API –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
- `/chat/api/task_status/<id>` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- `/chat/api/conversation/<id>/messages` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏
- `/chat/api/message/<id>/rate` - –æ—Ü–µ–Ω–∫–∞ –æ—Ç–≤–µ—Ç–∞

### 3. –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å

- **`chat/index.html`** - —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –≤—ã–±–æ—Ä–∞ –ø–æ–º–æ—â–Ω–∏–∫–∞
- **`chat/conversation.html`** - –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —á–∞—Ç–∞ —Å real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏

### 4. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

- –°–æ–∑–¥–∞–Ω—ã –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è –Ω–æ–≤—ã—Ö —Ç–∞–±–ª–∏—Ü –∏ –ø–æ–ª–µ–π
- –î–æ–±–∞–≤–ª–µ–Ω—ã —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ `test_assistant.py`

## –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### 1. –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å Flask –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
python wsgi.py

# –í –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å Celery worker
celery -A celery_worker.celery worker --loglevel=info

# –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –∑–∞–ø—É—â–µ–Ω—ã:
# - Redis (–ø–æ—Ä—Ç 6379)
# - Qdrant (–ø–æ—Ä—Ç 6333)
# - Ollama —Å –º–æ–¥–µ–ª—å—é
```

### 2. –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É

- –õ–æ–≥–∏–Ω: `test_user`
- –ü–∞—Ä–æ–ª—å: `password123`

### 3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —á–∞—Ç–∞

1. –ü–µ—Ä–µ–π—Ç–∏ –≤ —Ä–∞–∑–¥–µ–ª "üí¨ –ß–∞—Ç —Å –ø–æ–º–æ—â–Ω–∏–∫–æ–º" –≤ –º–µ–Ω—é
2. –í—ã–±—Ä–∞—Ç—å –æ–¥–Ω–æ–≥–æ –∏–∑ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ø–æ–º–æ—â–Ω–∏–∫–æ–≤:
   - "–ü–æ–º–æ—â–Ω–∏–∫ —Å–ª—É–∂–±—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏"
   - "Q&A –ü–æ–º–æ—â–Ω–∏–∫"
3. –ù–∞—á–∞—Ç—å –¥–∏–∞–ª–æ–≥ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ —á–∞—Ç–∞

## –ö–æ–Ω—Ü–µ–ø—Ü–∏—è —Ä–∞–±–æ—Ç—ã

### –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö:
1. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å** ‚Üí –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —á–∞—Ç
2. **Message** ‚Üí —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ë–î —Å role='user'
3. **Semantic Search** ‚Üí –ø–æ–∏—Å–∫ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —á–∞–Ω–∫–æ–≤ –≤ –≤–µ–∫—Ç–æ—Ä–Ω–æ–π –ë–î
4. **LLM Processing** ‚Üí –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
5. **Message** ‚Üí —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ —Å role='assistant'
6. **UI Update** ‚Üí –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ –≤ —á–∞—Ç–µ

### –ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏:
- **Application** = –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π + –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–º–æ—â–Ω–∏–∫–∞
- **Checklist** = –®–∞–±–ª–æ–Ω –ø—Ä–æ–º–ø—Ç–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- **Conversation** = –î–∏–∞–ª–æ–≥ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- **Message** = –ò—Å—Ç–æ—Ä–∏—è –æ–±—â–µ–Ω–∏—è —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

1. **–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å** - –¥–∏–∞–ª–æ–≥–æ–≤—ã–π —Ä–µ–∂–∏–º –≤–º–µ—Å—Ç–æ –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
2. **–ì–∏–±–∫–æ—Å—Ç—å** - —Ä–∞–∑–Ω—ã–µ –ø–æ–º–æ—â–Ω–∏–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∑–∞–¥–∞—á
3. **–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ** - —à–∞–±–ª–æ–Ω—ã –ø—Ä–æ–º–ø—Ç–æ–≤ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å —Ä–∞–∑–Ω—ã–º–∏ –ø–æ–º–æ—â–Ω–∏–∫–∞–º–∏
4. **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** - –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã—Ö –ø–æ–º–æ—â–Ω–∏–∫–æ–≤
5. **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞** - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤

## –î–∞–ª—å–Ω–µ–π—à–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

### –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å:
1. ‚úÖ –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è `search_tasks.py` –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø–æ–¥ single-query —Ä–µ–∂–∏–º
2. ‚è≥ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ streaming –æ—Ç–≤–µ—Ç–æ–≤ –¥–ª—è –ª—É—á—à–µ–≥–æ UX
3. ‚è≥ –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º –¥–ª—è –¥–ª–∏–Ω–Ω—ã—Ö –¥–∏–∞–ª–æ–≥–æ–≤
4. ‚è≥ –≠–∫—Å–ø–æ—Ä—Ç/–∏–º–ø–æ—Ä—Ç –¥–∏–∞–ª–æ–≥–æ–≤
5. ‚è≥ –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –º–µ—Ç—Ä–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:
- Markdown —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –≤ —á–∞—Ç–µ
- –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ –≤ –¥–∏–∞–ª–æ–≥
- –ì–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥/–≤—ã–≤–æ–¥
- –ú—É–ª—å—Ç–∏—è–∑—ã—á–Ω–æ—Å—Ç—å
- Fine-tuning –º–æ–¥–µ–ª–µ–π –Ω–∞ —É—Å–ø–µ—à–Ω—ã—Ö –¥–∏–∞–ª–æ–≥–∞—Ö

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:
- –ü–æ–ª–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º
- –°—Ç–∞—Ä—ã–µ –∑–∞—è–≤–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ –ø–æ–º–æ—â–Ω–∏–∫–∏
- –ß–µ–∫-–ª–∏—Å—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ —à–∞–±–ª–æ–Ω—ã –ø—Ä–æ–º–ø—Ç–æ–≤

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —á–µ—Ä–µ–∑ Celery
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∞—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)
- –ë–∞—Ç—á–∏–Ω–≥ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ LLM (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–æ–º–æ—â–Ω–∏–∫–∞–º
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- Rate limiting (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ —É—Å–ø–µ—à–Ω–æ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∞ –∏–∑ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—É—é –ø–ª–∞—Ç—Ñ–æ—Ä–º—É –ø–æ–º–æ—â–Ω–∏–∫–æ–≤. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤—Å—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (Qdrant, Celery, LLM), –Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω –Ω–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ –≥–∏–±–∫–æ—Å—Ç–∏.

–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è - —ç—Ç–æ MVP (Minimum Viable Product), –≥–æ—Ç–æ–≤—ã–π –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é –∏ –¥–∞–ª—å–Ω–µ–π—à–µ–º—É —Ä–∞–∑–≤–∏—Ç–∏—é.